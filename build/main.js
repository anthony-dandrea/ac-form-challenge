"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}/*
  Normally would throw this all in an IIFE to encapsulate these variables.
  But left them global so one could more easily play around in the console.
*/var SESSION_STORATE_ID="donationFund",form=document.forms.donateForm,reset=document.querySelector("[data-reset]"),amount=document.getElementById("amount"),diff=document.querySelector("[data-diff]"),donorCount=document.querySelector("[data-donors]"),ariaLive=document.getElementById("ariaLive"),progress=document.querySelector("progress"),time=document.querySelector("time"),fieldset=form.querySelector("fieldset"),blurb=document.querySelector(".topBlurb"),isDone=!1,projectFundDefaultConfig={goal:5e3,current:0,donors:0},ProjectFund=function ProjectFund(){var a=this,b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:projectFundDefaultConfig,c=b.goal,d=b.current,e=b.donors,f=1<arguments.length?arguments[1]:void 0,g=f.onDonate,h=f.onDone;_classCallCheck(this,ProjectFund),_defineProperty(this,"donate",function(){var b,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(a.current+=c,a.donors++,a.difference=a.goal-a.current,null===(b=a.onDonate)||void 0===b?void 0:b.call(a,a),a.save(),0===a.difference){var d;null===(d=a.onDone)||void 0===d?void 0:d.call(a,a)}}),_defineProperty(this,"save",function(){var b=a.goal,c=a.current,d=a.donors,e=a.difference;sessionStorage[SESSION_STORATE_ID]=JSON.stringify({goal:b,current:c,donors:d})}),_defineProperty(this,"reset",function(){var b,c=projectFundDefaultConfig.goal,d=projectFundDefaultConfig.current,e=projectFundDefaultConfig.donors;a.goal=c,a.current=d,a.donors=e,a.difference=a.goal-a.current,null===(b=a.onDonate)||void 0===b?void 0:b.call(a,a)}),this.goal=c,this.current=d,this.donors=e,this.difference=c-d,this.onDone=h,this.onDonate=g,null===g||void 0===g?void 0:g(this),0===this.difference&&h&&h(this)},tryParse=function(a){var b;try{b=JSON.parse(a)}catch(a){// Would likely save an error log somewhere here
}return b},initConfig=tryParse(sessionStorage.donationFund),pluralize=function(a,b){return 1===b?a:"".concat(a,"s")},onDone=function(a){var b=a.donors;form.querySelector("h1").innerText="Project fully funded!\uD83C\uDF88\uD83C\uDF89\uD83C\uDF8A",form.querySelector("p").innerText="Thanks to the ".concat(b," ").concat(pluralize("donor",b)," who supported this project."),fieldset.classList.add("hidden"),blurb.classList.add("hidden"),isDone=!0},onDonate=function(a){var b=a.goal,c=a.current,d=a.difference,e=a.donors;// Reset form
diff&&(diff.innerText=d),donorCount&&(donorCount.innerText=e),amount&&(amount.max=d,5>d&&(amount.min=1)),ariaLive&&amount.value&&(ariaLive.innerText="Success! Thank you for your donation of ".concat(amount.value," dollars!")),progress&&(progress.max=b,progress.value=c,progress.innerText=c),null===form||void 0===form?void 0:form.reset()},fund=new ProjectFund(initConfig,{onDonate:onDonate,onDone:onDone});// Query DOM and save necessary elements
null===form||void 0===form?void 0:form.addEventListener("submit",function(a){a.preventDefault(),amount&&fund.donate(parseInt(amount.value))}),null===reset||void 0===reset?void 0:reset.addEventListener("click",function(){fund.reset(),delete sessionStorage[SESSION_STORATE_ID],isDone&&location.reload()});// Set four days from now for time tag
// IRL, for this you would likely have a fixed date for the end of the funding.
var futureDate=new Date;// 4 days ahead
futureDate.setDate(futureDate.getDate()+4),time.dateTime="".concat(futureDate.getFullYear(),"-").concat(futureDate.getMonth()+1,"-").concat(futureDate.getDate());
//# sourceMappingURL=build/main.js.map
